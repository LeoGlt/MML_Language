suppressPackageStartupMessages(library(utils))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(caret))
suppressPackageStartupMessages(library(e1071))
suppressPackageStartupMessages(library(lattice))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(randomForest))
suppressPackageStartupMessages(library(rjson))
data <- read.csv("upload/Spotify.csv", sep=';')
y <-"like"
X <- c('danceability','energy','mode','tempo','time_signature')
formula = as.formula(paste(y, paste(X,collapse = " + "), sep = " ~ "))
results = list()
fit.control <- trainControl(method = "cv", number = 5)
results[[1]] = list(model=c(), output=list())
results[[1]]$model = "Random Forest"
clf = train(y=data[,y], x = data[,X], method = "rf", trControl = fit.control)
y_pred=predict(clf, data, type = "raw")
mat_conf <- table(y_pred,unlist(data %>% select(y)))
accuracy = sum(diag(mat_conf))/sum(mat_conf)
results[[1]]$output[[1]] = list(metric = "accuracy", value = accuracy)
print(writeLines(toJSON(results)))
